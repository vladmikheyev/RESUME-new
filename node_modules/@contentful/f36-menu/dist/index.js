'use strict';

var F = require('react');
var f36Core = require('@contentful/f36-core');
var f36Popover = require('@contentful/f36-popover');
var emotion = require('emotion');
var b = require('@contentful/f36-tokens');
var f36Typography = require('@contentful/f36-typography');
var f36Icons = require('@contentful/f36-icons');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var F__default = /*#__PURE__*/_interopDefault(F);
var b__default = /*#__PURE__*/_interopDefault(b);

var Fe=Object.defineProperty,We=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var ue=(e,t,o)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,u=(e,t)=>{for(var o in t||(t={}))me.call(t,o)&&ue(e,o,t[o]);if(W)for(var o of W(t))ae.call(t,o)&&ue(e,o,t[o]);return e},C=(e,t)=>We(e,Be(t));var x=(e,t)=>{var o={};for(var n in e)me.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&W)for(var n of W(e))t.indexOf(n)<0&&ae.call(e,n)&&(o[n]=e[n]);return o};var ce={vertical:{prev:"ArrowUp",next:"ArrowDown"},horizontal:{prev:"ArrowLeft",next:"ArrowRight"}},pe=({itemsContainerRef:e,itemsSelector:t,keyType:o="vertical"})=>{let[n,s]=F.useState(0),a=F.useCallback(i=>{let l=e.current;if(!l)return;let T=l.querySelectorAll(t);if(T.length===0)return;let c=T.length-1,S=()=>s(0),g=()=>s(c),f=()=>{n===c?S():s(n+1);},h=()=>{n===0?g():s(n-1);},y={[ce[o].next]:f,[ce[o].prev]:h}[i.key];y&&(i.preventDefault(),y());},[n,t,e,o]);return {focusedIndex:n,handleArrowsKeyDown:a,setFocusedIndex:s}};var fe=F__default.default.createContext(void 0),O=()=>{let e=F__default.default.useContext(fe);if(e===void 0)throw new Error("useMenuContext must be used within a MenuContextProvider");return e},de=fe.Provider;var z='[role="menuitem"]:not(:disabled)';function B(e){let oe=e,{closeOnSelect:t=!0,closeOnBlur:o=!0,closeOnEsc:n=!0,children:s,onOpen:a}=oe,i=x(oe,["closeOnSelect","closeOnBlur","closeOnEsc","children","onOpen"]),{isOpen:l,handleOpen:T,handleClose:c,isControlled:S}=f36Core.useControllableState({isOpen:e.isOpen,defaultIsOpen:e.defaultIsOpen,onOpen:a,onClose:e.onClose}),g=F.useRef(null),f=F.useRef(null),h=f36Core.useId(null,"menu"),{focusedIndex:M,handleArrowsKeyDown:y,setFocusedIndex:m}=pe({itemsContainerRef:f,itemsSelector:z});F.useEffect(()=>{if(l&&f.current){let r=f.current.querySelectorAll(z);r.length>0&&M<r.length&&setTimeout(()=>{r[M].focus({preventScroll:!1});},0);}},[l,M]);let I=F.useCallback(r=>{let d=[...f.current.querySelectorAll(z)].findIndex(P=>r===P);d!==-1&&m(d);},[m]),p=F.useCallback(()=>{var r;c(),(r=g.current)==null||r.focus({preventScroll:!0});},[c]),E=F.useCallback(r=>{if(r.key==="Tab"){r.preventDefault(),p();return}if(r.stopPropagation(),r.key==="ArrowLeft"){r.preventDefault(),p();return}y(r);},[p,y]),K=F.useRef(!1),De=F.useMemo(()=>({isOpen:l,menuId:h,focusMenuItem:I,getTriggerProps:(r={},w=null)=>({onMouseDown:d=>{var P;K.current=!0,(P=r.onMouseDown)==null||P.call(r,d);},onMouseUp:d=>{var P;K.current=!1,(P=r.onMouseUp)==null||P.call(r,d);},onClick:d=>{var v;S&&!a||(l?c():T()),(v=r.onClick)==null||v.call(r,d);},ref:f36Core.mergeRefs(g,w)}),getMenuListProps:(r={},w=null)=>({ref:f36Core.mergeRefs(f,w),onKeyDown:d=>{var P;E(d),(P=r.onKeyDown)==null||P.call(r,d);},onBlur:d=>{var ne,re,se,ie;if((ne=r.onBlur)==null||ne.call(r,d),!o)return;let P=document.activeElement,v=d.relatedTarget||P,He=f.current===v||((re=f.current)==null?void 0:re.contains(v)),Ne=g.current===v||((se=g.current)==null?void 0:se.contains(v))||K.current,Ae=((ie=v==null?void 0:v.parentElement)==null?void 0:ie.dataset.parentMenu)===h;if(He||Ne||Ae){d.stopPropagation();return}c();}}),getMenuItemProps:(r={})=>({onClick:w=>{var P;(P=r.onClick)==null||P.call(r,w);let d=!!w.target.getAttribute("aria-haspopup");t&&!d&&p();}}),propsToPropagateToSubmenus:{closeOnSelect:t,closeOnBlur:o,closeOnEsc:n}}),[h,l,E,t,c,T,I,o,n,p,S,a]);return F__default.default.createElement(de,{value:De},F__default.default.createElement(f36Popover.Popover,C(u({},i),{isOpen:l,onClose:c,id:h,closeOnEsc:n,autoFocus:!1,closeOnBlur:!1}),s))}var Pe=F__default.default.createContext(void 0),U=()=>F__default.default.useContext(Pe),xe=Pe.Provider;var be=()=>emotion.css({position:"sticky",top:0,left:0,backgroundColor:b__default.default.colorWhite,borderBottom:`1px solid ${b__default.default.gray300}`,marginBottom:b__default.default.spacing2Xs,padding:`${b__default.default.spacing2Xs} 0`,zIndex:1001}),Te=()=>emotion.css({position:"sticky",bottom:0,left:0,backgroundColor:b__default.default.colorWhite,borderTop:`1px solid ${b__default.default.gray300}`,marginTop:b__default.default.spacing2Xs,padding:`${b__default.default.spacing2Xs} 0`,zIndex:1001}),he=e=>({container:emotion.css({borderRadius:"8px",overflowY:"auto",position:"relative",padding:0,paddingTop:e.hasStickyHeader?0:b__default.default.spacing2Xs,paddingBottom:e.hasStickyFooter?0:b__default.default.spacing2Xs})});var k=e=>{let i=e,{children:t,testId:o="cf-ui-menu-list-header",className:n}=i,s=x(i,["children","testId","className"]),a=be();return F__default.default.createElement("div",u({"data-test-id":o,className:emotion.cx(a,n)},s),t)};k.displayName="MenuListHeader";var D=e=>{let i=e,{children:t,testId:o="cf-ui-menu-list-footer",className:n}=i,s=x(i,["children","testId","className"]),a=Te();return F__default.default.createElement("div",u({"data-test-id":o,className:emotion.cx(a,n)},s),t)};D.displayName="MenuListFooter";function _e(e){var t;return !!((t=e==null?void 0:e.type)!=null&&t.displayName)}var et=(e,t)=>{let h=e,{children:o,testId:n="cf-ui-menu-list",className:s}=h,a=x(h,["children","testId","className"]),{getMenuListProps:i}=O(),l=U(),T=null,c=null,S=[];F__default.default.Children.forEach(o,M=>{let y=!0;_e(M)&&(M.type.displayName===k.displayName?(T=M,y=!1):M.type.displayName===D.displayName&&(c=M,y=!1)),y&&S.push(M);});let g=he({hasStickyHeader:!!T,hasStickyFooter:!!c}),f=l?l.getSubmenuListProps(a):a;return F__default.default.createElement(f36Popover.Popover.Content,C(u(u({role:"menu"},f),i(f,t)),{className:emotion.cx(g.container,s),testId:n}),T,S,c)},q=F__default.default.forwardRef(et);var ot={backgroundColor:b__default.default.gray200,fontWeight:b__default.default.fontWeightMedium,"&:hover":{backgroundColor:b__default.default.gray200}},Se={opacity:.5,cursor:"auto","&:hover":{backgroundColor:"unset"}},Ce=({isActive:e,isDisabled:t})=>({root:emotion.css([{alignItems:"center",gap:b__default.default.spacingXs,display:"flex",width:`calc(100% - 2 * ${b__default.default.spacing2Xs})`,background:"none",border:0,borderRadius:b__default.default.borderRadiusMedium,margin:`0 ${b__default.default.spacing2Xs}`,outline:"none",fontSize:b__default.default.fontSizeM,lineHeight:b__default.default.lineHeightM,fontWeight:b__default.default.fontWeightNormal,position:"relative",textAlign:"left",padding:`6px ${b__default.default.spacingXs}`,wordBreak:"break-word",whiteSpace:"break-spaces",cursor:"pointer",hyphens:"auto",minWidth:"150px",textDecoration:"none",color:b__default.default.gray900,'[role="menuitem"] + &':{marginTop:"2px"},"&:hover":{backgroundColor:b__default.default.gray100},"&:focus":{boxShadow:`inset ${b__default.default.glowPrimary}`},"&:focus:not(:focus-visible)":{boxShadow:"unset"},"&:focus-visible":{boxShadow:`inset ${b__default.default.glowPrimary}`},"&:active":{backgroundColor:b__default.default.gray200},"&:disabled":Se}],e&&ot,t&&Se)});var mt="button";function Ee(e,t){let I=e,{testId:o,className:n,as:s,isActive:a=!1,isDisabled:i=!1,isInitiallyFocused:l,icon:T}=I,c=x(I,["testId","className","as","isActive","isDisabled","isInitiallyFocused","icon"]),S=f36Core.useId(void 0,"menu-item"),g=o||`cf-ui-${S}`,f=Ce({isActive:a,isDisabled:i}),{getMenuItemProps:h,focusMenuItem:M}=O(),y=F.useRef(null);F.useEffect(()=>{l&&y.current&&M(y.current);},[l,M]);let m=s!=null?s:mt;return F__default.default.createElement(m,C(u(u({role:"menuitem"},c),h(c)),{className:emotion.cx(f.root,n),"data-test-id":g,ref:f36Core.mergeRefs(y,t),tabIndex:-1}),T,e.children)}Ee.displayName="MenuItem";var H=F__default.default.forwardRef(Ee);var N=e=>{let t=F__default.default.Children.only(e.children),{getTriggerProps:o}=O();return F__default.default.createElement(f36Popover.Popover.Trigger,null,F__default.default.cloneElement(t,C(u({},o(t.props,t.ref)),{"aria-haspopup":"menu"})))};var Le=()=>emotion.css({border:"none",width:"100%",height:"1px",backgroundColor:b__default.default.gray200,margin:`${b__default.default.spacing2Xs} 0`});var V=e=>{let i=e,{children:t,testId:o="cf-ui-menu-divider",className:n}=i,s=x(i,["children","testId","className"]),a=Le();return F__default.default.createElement("hr",u({"aria-orientation":"horizontal","data-test-id":o,className:emotion.cx(a,n)},s))};var Re=()=>emotion.css({color:b__default.default.gray500,textAlign:"left",padding:`${b__default.default.spacingXs} ${b__default.default.spacingS} ${b__default.default.spacing2Xs}`,lineHeight:b__default.default.lineHeightM});var J=e=>{let i=e,{children:t,testId:o="cf-ui-menu-section-title",className:n}=i,s=x(i,["children","testId","className"]),a=Re();return F__default.default.createElement(f36Typography.Caption,u({"aria-hidden":"true",as:"div",testId:o,className:emotion.cx(a,n),marginBottom:"none"},s),t)};var Tt=[-8,2],Z=e=>{let y=e,{onClose:t,onOpen:o}=y,n=x(y,["onClose","onOpen"]),{isOpen:s,menuId:a,propsToPropagateToSubmenus:i}=O(),l=F.useRef(null),T=F.useRef(null),[c,S]=F.useState(!1),g=F.useCallback(()=>{S(!0),window.clearTimeout(T.current),o==null||o();},[o]),f=F.useCallback(()=>{S(!1),window.clearTimeout(T.current),t==null||t();},[t]),h=F.useCallback(()=>{var m;f(),(m=l.current)==null||m.focus({preventScroll:!0});},[f]);F.useEffect(()=>{s===!1&&S(!1);},[s]);let M=F.useMemo(()=>({isOpen:c,getSubmenuListProps:m=>({"data-parent-menu":a,onMouseOver:I=>{var p;g(),(p=m.onMouseOver)==null||p.call(m,I);},onMouseLeave:I=>{var p;h(),(p=m.onMouseLeave)==null||p.call(m,I);}}),getSubmenuTriggerProps:(m,I)=>({ref:f36Core.mergeRefs(l,I),onKeyDown:p=>{var E;p.key==="ArrowRight"&&(p.preventDefault(),g()),(E=m.onKeyDown)==null||E.call(m,p);},onMouseOver:p=>{var E;g(),(E=m.onMouseOver)==null||E.call(m,p);},onMouseLeave:p=>{var E;T.current=window.setTimeout(h,300),(E=m.onMouseLeave)==null||E.call(m,p);}})}),[c,a,g,h]);return F__default.default.createElement(xe,{value:M},F__default.default.createElement(B,C(u(u({},i),n),{isOpen:c,onClose:f,onOpen:g,placement:"right-start",offset:Tt,isAutoalignmentEnabled:!1})))};var ke=()=>({root:({isActive:e})=>emotion.css(u({display:"flex",alignItems:"center",paddingRight:b__default.default.spacingXs},e?{backgroundColor:b__default.default.gray100}:{})),content:emotion.css({marginRight:b__default.default.spacingM}),icon:emotion.css({marginLeft:"auto",fill:"currentColor"})});var Ct=(e,t)=>{let{className:o,children:n}=e,{getSubmenuTriggerProps:s,isOpen:a}=U(),i=ke();return F__default.default.createElement(N,null,F__default.default.createElement(H,C(u(u({},e),s(e,t)),{className:emotion.cx(i.root({isActive:a}),o)}),F__default.default.createElement("span",{className:i.content},n),F__default.default.createElement(f36Icons.ChevronRightIcon,{className:i.icon})))},te=F__default.default.forwardRef(Ct);var R=B;R.List=q;R.ListHeader=k;R.ListFooter=D;R.Item=H;R.Trigger=N;R.Divider=V;R.SectionTitle=J;R.Submenu=Z;R.SubmenuTrigger=te;

exports.Menu = R;
exports.MenuDivider = V;
exports.MenuItem = H;
exports.MenuList = q;
exports.MenuSectionTitle = J;
exports.MenuTrigger = N;
exports.Submenu = Z;
exports.SubmenuTrigger = te;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map